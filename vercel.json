{
    "version": 2,
    "name": "employee-management-nextjs",
    "alias": ["employee-management.vercel.app"],
    "regions": ["iad1", "fra1"],
    "framework": "nextjs",

    "build": {
        "env": {
            "NEXT_PUBLIC_APP_NAME": "Employee Management System",
            "NEXT_PUBLIC_APP_VERSION": "1.0.0",
            "NEXT_PUBLIC_VERCEL_ENV": "@vercel-env"
        }
    },

    "env": {
        "DATABASE_URL": "@database-url",
        "NEXTAUTH_SECRET": "@nextauth-secret",
        "NEXTAUTH_URL": "@nextauth-url",
        "JWT_SECRET": "@jwt-secret",
        "ENCRYPTION_KEY": "@encryption-key",
        "SMTP_HOST": "@smtp-host",
        "SMTP_PORT": "@smtp-port",
        "SMTP_USER": "@smtp-user",
        "SMTP_PASS": "@smtp-pass",
        "UPLOAD_SECRET": "@upload-secret",
        "WEBHOOK_SECRET": "@webhook-secret"
    },

    "functions": {
        "pages/api/**/*.ts": {
            "runtime": "nodejs18.x",
            "maxDuration": 30
        },
        "pages/api/auth/**/*.ts": {
            "runtime": "nodejs18.x",
            "maxDuration": 10
        },
        "pages/api/employees/**/*.ts": {
            "runtime": "nodejs18.x",
            "maxDuration": 25
        },
        "pages/api/attendance/**/*.ts": {
            "runtime": "nodejs18.x",
            "maxDuration": 20
        },
        "pages/api/payroll/**/*.ts": {
            "runtime": "nodejs18.x",
            "maxDuration": 30
        },
        "pages/api/reports/**/*.ts": {
            "runtime": "nodejs18.x",
            "maxDuration": 45
        },
        "pages/api/uploads/**/*.ts": {
            "runtime": "nodejs18.x",
            "maxDuration": 60
        }
    },

    "headers": [{
            "source": "/(.*)",
            "headers": [{
                    "key": "X-Frame-Options",
                    "value": "DENY"
                },
                {
                    "key": "X-Content-Type-Options",
                    "value": "nosniff"
                },
                {
                    "key": "Referrer-Policy",
                    "value": "strict-origin-when-cross-origin"
                },
                {
                    "key": "Permissions-Policy",
                    "value": "camera=(), microphone=(), geolocation=()"
                }
            ]
        },
        {
            "source": "/api/(.*)",
            "headers": [{
                    "key": "Access-Control-Allow-Origin",
                    "value": "https://employee-management.vercel.app"
                },
                {
                    "key": "Access-Control-Allow-Methods",
                    "value": "GET, POST, PUT, DELETE, PATCH, OPTIONS"
                },
                {
                    "key": "Access-Control-Allow-Headers",
                    "value": "X-Requested-With, Content-Type, Authorization, X-API-Key"
                },
                {
                    "key": "Access-Control-Allow-Credentials",
                    "value": "true"
                },
                {
                    "key": "Cache-Control",
                    "value": "s-maxage=0, stale-while-revalidate"
                }
            ]
        },
        {
            "source": "/dashboard/(.*)",
            "headers": [{
                    "key": "X-Robots-Tag",
                    "value": "noindex, nofollow"
                },
                {
                    "key": "Cache-Control",
                    "value": "private, no-cache, no-store, must-revalidate"
                }
            ]
        },
        {
            "source": "/(.*\\.(css|js|png|jpg|jpeg|gif|svg|webp|ico|woff|woff2))",
            "headers": [{
                "key": "Cache-Control",
                "value": "public, max-age=31536000, immutable"
            }]
        }
    ],

    "redirects": [{
            "source": "/",
            "has": [{
                "type": "cookie",
                "key": "auth-token"
            }],
            "destination": "/dashboard",
            "permanent": false
        },
        {
            "source": "/dashboard",
            "destination": "/dashboard/overview",
            "permanent": false
        },
        {
            "source": "/employees",
            "destination": "/dashboard/employees",
            "permanent": false
        },
        {
            "source": "/attendance",
            "destination": "/dashboard/attendance",
            "permanent": false
        },
        {
            "source": "/payroll",
            "destination": "/dashboard/payroll",
            "permanent": false
        },
        {
            "source": "/reports",
            "destination": "/dashboard/reports",
            "permanent": false
        },
        {
            "source": "/admin",
            "destination": "/dashboard/admin",
            "permanent": false
        }
    ],

    "rewrites": [{
            "source": "/api/v1/(.*)",
            "destination": "/api/$1"
        },
        {
            "source": "/health",
            "destination": "/api/health"
        },
        {
            "source": "/ping",
            "destination": "/api/ping"
        }
    ],

    "routes": [{
            "src": "/sitemap.xml",
            "dest": "/api/sitemap"
        },
        {
            "src": "/robots.txt",
            "dest": "/api/robots"
        },
        {
            "src": "/favicon.ico",
            "dest": "/favicon.ico"
        }
    ],

    "crons": [{
            "path": "/api/cron/daily-backup",
            "schedule": "0 2 * * *"
        },
        {
            "path": "/api/cron/attendance-reminder",
            "schedule": "0 9 * * 1-5"
        },
        {
            "path": "/api/cron/payroll-processing",
            "schedule": "0 0 1 * *"
        },
        {
            "path": "/api/cron/cleanup-logs",
            "schedule": "0 3 * * 0"
        }
    ],

    "github": {
        "enabled": true,
        "autoJobCancelation": true
    },

    "installCommand": "npm ci",
    "buildCommand": "npm run build",
    "outputDirectory": ".next",

    "ignoreCommand": "bash ignore-build.sh",

    "cleanUrls": true,
    "trailingSlash": false,

    "public": false,

    "scope": "employee-management",

    "git": {
        "deploymentEnabled": {
            "main": true,
            "develop": true
        }
    }
}